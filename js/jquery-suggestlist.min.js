(function(d){function b(f,e){var g=this;this.$element=d(f).attr("autocomplete","off");this.options=d.extend(d.fn.durationpicker.defaults,e);this.picker=c.render(e).on("click.durationpicker","li",d.proxy(this.click,this));this.isInput=this.$element.is("input");this.picker.width(this.$element.outerWidth());d(document).on("mousedown",function(h){if(d(h.target).closest(".durationpicker").length==0){g.hide()}});if(this.isInput){this.$element.on({focus:d.proxy(this.show,this),keydown:d.proxy(this.keydown,this),keyup:d.proxy(this.updateLi,this)})}}b.prototype={constructor:b,click:function(e){this.picker.find("li.durationpicker-selected").removeClass("durationpicker-selected");d(e.currentTarget).addClass("durationpicker-selected");this.updateVal()},keydown:function(e){switch(e.keyCode){case 27:this.hide();e.preventDefault();break;case 9:this.hide();break;case 38:if(this.picker.is(":not(:visible)")){this.show();return}this.selectPrev();break;case 40:if(this.picker.is(":not(:visible)")){this.show();return}this.selectNext();break;case 13:this.updateVal(e);e.preventDefault();break}},show:function(e){this.picker.show();this.place();d(window).on("resize",d.proxy(this.place,this));if(e){e.stopPropagation();e.preventDefault()}},hide:function(e){this.picker.hide();d(window).off("resize",d.proxy(this.place,this))},place:function(){var e=this.$element.offset();this.picker.css({left:e.left,top:e.top+this.$element.outerHeight()})},selectNext:function(){var f,e;f=this.picker.find("li.durationpicker-selected").first();if(f.length===0){e=this.picker.find("li").first()}else{if(f.is(":last-child")){return}e=f.removeClass("durationpicker-selected").next()}e.addClass("durationpicker-selected")},selectPrev:function(){var f,e;f=this.picker.find("li.durationpicker-selected").first();if(f.length===0){e=this.picker.find("li").last()}else{if(f.is(":first-child")){return}e=f.removeClass("durationpicker-selected").prev()}e.addClass("durationpicker-selected")},updateVal:function(e){this.$element.val(this.picker.find("li.durationpicker-selected").text());this.hide()},updateLi:function(g){var e=String.fromCharCode(g.keyCode).toLowerCase();if(g.ctrlKey||!/^[0-9a-z ]$/.test(e)){return}var h=d.trim(this.$element.val()).replace(/\s+/," "),i=this.picker.find("li"),f=i.filter(".durationpicker-selected").first();if(h===f.text()){return}if(d.inArray(h,this.options.list)===-1){return false}f.removeClass("durationpicker-selected");this.picker.find("li").each(function(j,k){if(d(k).text()===h){d(k).addClass("durationpicker-selected")}});this.show()}};var c={render:function(f){var e=d("<ul/>"),g;e.addClass("durationpicker").css({zIndex:a(this.$element),});for(g=0;g<f.list.length;g++){e.append("<li>"+f.list[g]+"</li>");if(g===0){e.addClass("durationpicker-selected")}}e.appendTo("body");return e}};function a(e){if(!e){return}return parseInt(e.parents().filter(function(){return d(this).css("z-index")!=="auto"}).first().css("z-index"),10)}d.fn.durationpicker=function(f){var e=Array.apply(null,arguments);e.shift();return this.each(function(){var i=d(this),h=i.data("durationpicker"),g=typeof option=="object"&&option;if(!h){h=new b(this,d.extend({},d.fn.durationpicker.defaults,g));i.data("durationpicker",h)}if(typeof option=="string"&&typeof h[option]=="function"){h[option].apply(h,e)}})};d.fn.durationpicker.defaults={list:["15 min","30 min","1 hr","2 hr"]}})(jQuery);